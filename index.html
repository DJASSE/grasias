<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ثانوية أمــوشان رابح بقدارة</title>

  <!-- Google Font (Arabic-friendly) -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- FontAwesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    /* =======================
       Reset & Base
       ======================= */
    :root{
      --bg: #f6fbff;
      --card: #ffffff;
      --blue: #0b67b2;
      --green: #2aa66a;
      --muted: #6b7280;
      --glass: rgba(255,255,255,0.6);
      --accent: linear-gradient(135deg,var(--blue),#1ea6ff 60%, #2aa66a);
      --shadow: 0 6px 20px rgba(11,103,178,0.08);
      --glass-2: rgba(255,255,255,0.85);
      --radius: 12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Cairo', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#f6fbff 0%, #ffffff 100%);
      color:#08304b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }
    a{color:inherit;text-decoration:none}

    /* =======================
       Top Notification Bar
       ======================= */
    .notif-bar{
      background: var(--blue);
      color: #fff;
      padding:8px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      font-weight:600;
      position:sticky;
      top:0;
      z-index:1000;
      box-shadow:0 4px 12px rgba(11,103,178,0.12);
    }
    .notif-left{display:flex;align-items:center;gap:12px}
    .notif-msg{
      display:inline-block;
      overflow:hidden;
      white-space:nowrap;
      animation: marquee 12s linear infinite;
      max-width:70vw;
    }
    .notif-actions{display:flex;gap:8px;align-items:center}
    .notif-close{
      background:transparent;border:1px solid rgba(255,255,255,0.12);
      color:#fff;padding:6px 10px;border-radius:8px;cursor:pointer;
      transition:all .18s ease;
    }
    .notif-close:hover{transform:translateY(-2px);opacity:.95}

    @keyframes marquee{
      0%{transform:translateX(0)}
      100%{transform:translateX(-100%)}
    }

    /* =======================
       Header
       ======================= */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      padding:20px 28px;
      max-width:1200px;
      margin:18px auto;
    }
    .brand{
      display:flex;
      gap:14px;
      align-items:center;
    }
    .logo{
      width:72px;height:72px;
      border-radius:14px;
      display:grid;
      place-items:center;
      background:var(--accent);
      color:#fff;
      box-shadow:var(--shadow);
    }
    .logo svg{width:44px;height:44px}
    .school-title{
      display:flex;
      flex-direction:column;
      line-height:1;
    }
    .school-title .name{
      font-size:20px;font-weight:700;color:var(--blue);
    }
    .school-title .sub{
      font-size:13px;color:var(--muted);
    }

    nav.main-nav{
      display:flex;
      gap:12px;
      align-items:center;
      background:transparent;
    }
    nav a{
      padding:10px 14px;
      border-radius:10px;
      color:var(--blue);
      font-weight:600;
      transition:all .18s ease;
    }
    nav a:hover{
      background:rgba(11,103,178,0.06);
      transform:translateY(-3px);
    }

    /* Mobile menu button */
    .menu-btn{display:none}

    /* =======================
       Hero / Welcome
       ======================= */
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    .hero{
      background:linear-gradient(180deg, rgba(11,103,178,0.04), rgba(42,166,106,0.02));
      border-radius:16px;padding:22px;margin:0 auto 18px;display:flex;gap:20px;align-items:center;
      box-shadow:var(--shadow);
      justify-content:space-between;
      overflow:hidden;
    }
    .hero .welcome{
      max-width:60%;
    }
    .hero h1{
      margin:0;font-size:22px;color:var(--blue);
      letter-spacing:0.2px;
    }
    .hero p{margin:8px 0 0;color:var(--muted);font-size:15px}
    .hero .credit{
      margin-top:8px;font-size:13px;color:#0b4f84;background:rgba(11,103,178,0.06);display:inline-block;padding:6px 10px;border-radius:10px;
    }
    .hero .cta{
      display:flex;gap:10px;align-items:center;
    }
    .btn{
      background:var(--blue);color:#fff;padding:10px 14px;border-radius:10px;font-weight:700;border:none;cursor:pointer;
      box-shadow:0 6px 18px rgba(11,103,178,0.12);
      transition:transform .16s ease, box-shadow .16s ease, opacity .16s ease;
    }
    .btn.secondary{
      background:transparent;color:var(--blue);border:1px solid rgba(11,103,178,0.12);
      box-shadow:none;padding:10px 12px;
    }
    .btn:hover{transform:translateY(-4px)}
    .hero .slider{
      width:40%;
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 12px 40px rgba(8,48,75,0.06);
    }

    /* =======================
       Layout Grid
       ======================= */
    .grid{
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:20px;
      margin-bottom:28px;
    }

    /* =======================
       News Section
       ======================= */
    .card{
      background:var(--card);
      border-radius:12px;
      padding:16px;
      box-shadow:var(--shadow);
    }
    .news-section h2{
      margin:0 0 10px;font-size:18px;color:var(--blue);
      display:flex;align-items:center;gap:10px;
    }
    .news-list{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
      gap:12px;
    }
    .news-item{
      display:flex;flex-direction:column;gap:8px;padding:12px;border-radius:12px;background:linear-gradient(180deg, #fff,#fbfeff);
      transition:transform .18s ease, box-shadow .18s ease;
      border:1px solid rgba(11,103,178,0.04);
    }
    .news-item:hover{transform:translateY(-6px);box-shadow:0 18px 40px rgba(11,103,178,0.06)}
    .news-item .title{font-weight:700;color:#08304b}
    .news-item .meta{font-size:13px;color:var(--muted);display:flex;justify-content:space-between;gap:8px}
    .news-item .excerpt{font-size:14px;color:#12374f;opacity:.9}

    .admin-panel{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    .admin-panel input[type="text"], .admin-panel textarea, .admin-panel select{
      width:100%;padding:10px;border-radius:8px;border:1px solid rgba(8,48,75,0.08);font-size:14px;
    }
    .admin-row{display:flex;gap:8px}
    .admin-row .col{flex:1}

    /* =======================
       Sidebar: Schedules & Quick Info
       ======================= */
    .sidebar h3{margin:0 0 10px;color:var(--blue)}
    .schedule-table{
      width:100%;border-collapse:collapse;font-size:14px;
    }
    .schedule-table th, .schedule-table td{
      text-align:right;padding:10px;border-bottom:1px dashed rgba(8,48,75,0.06)
    }
    .time-pill{
      display:inline-block;background:rgba(42,166,106,0.12);color:var(--green);padding:6px 10px;border-radius:20px;font-weight:700
    }

    /* =======================
       Slider Styles
       ======================= */
    .slider-wrap{position:relative;overflow:hidden;height:170px}
    .slides{display:flex;transition:transform .6s cubic-bezier(.2,.9,.3,1);height:100%}
    .slide{min-width:100%;height:100%;display:grid;place-items:center;color:#fff;padding:14px;background-size:cover;background-position:center}
    .slide .caption{background:rgba(0,0,0,0.35);padding:10px 14px;border-radius:10px}
    .slider-controls{position:absolute;left:12px;right:12px;top:0;bottom:0;display:flex;align-items:center;justify-content:space-between;pointer-events:none}
    .slider-controls button{pointer-events:auto;background:rgba(0,0,0,0.28);color:#fff;border:0;padding:8px 10px;border-radius:10px;cursor:pointer;transition:opacity .12s}
    .slider-dots{display:flex;gap:6px;justify-content:center;padding:10px;margin-top:8px}
    .dot{width:8px;height:8px;border-radius:99px;background:rgba(11,103,178,0.28);cursor:pointer}
    .dot.active{background:var(--green)}

    /* =======================
       Footer
       ======================= */
    footer{
      margin-top:28px;background:linear-gradient(180deg,#fff,#f7fcff);padding:26px;border-top:1px solid rgba(8,48,75,0.04)
    }
    .footer-grid{display:flex;flex-wrap:wrap;gap:20px;justify-content:space-between;align-items:flex-start;max-width:1200px;margin:0 auto}
    .contact-item{display:flex;gap:12px;align-items:center;color:var(--muted)}
    .socials a{display:inline-block;margin-left:8px;color:var(--blue);padding:8px;border-radius:8px;transition:all .12s}
    .socials a:hover{transform:translateY(-4px);background:rgba(11,103,178,0.06)}

    /* =======================
       Responsive
       ======================= */
    @media (max-width:980px){
      .grid{grid-template-columns:1fr}
      .hero{flex-direction:column;align-items:flex-start}
      .hero .slider, .hero .welcome{width:100%;max-width:100%}
      .brand .school-title .name{font-size:18px}
    }
    @media (max-width:640px){
      header{padding:14px}
      nav.main-nav{display:none}
      .menu-btn{display:inline-flex;background:transparent;border:1px solid rgba(8,48,75,0.06);padding:8px;border-radius:10px;cursor:pointer}
      .hero h1{font-size:18px}
      .notif-msg{max-width:48vw}
      .slides{transition:transform .45s cubic-bezier(.2,.9,.3,1)}
      .hero{padding:16px}
    }
  </style>
</head>
<body>

  <!-- ============= Notification Bar ============= -->
  <div class="notif-bar" id="notifBar" role="region" aria-live="polite">
    <div class="notif-left">
      <i class="fa-solid fa-bullhorn" style="font-size:18px"></i>
      <div class="notif-msg" id="notifMsg">بداية العام الدراسي: تبدأ الدراسة يوم الاثنين 1 سبتمبر. الرجاء متابعة التحديثات هنا.</div>
    </div>
    <div class="notif-actions">
      <button class="notif-close" id="notifToggle"><i class="fa-regular fa-bell"></i> إخفاء</button>
    </div>
  </div>

  <!-- ============= Header ============= -->
  <header class="container">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <!-- Small SVG logo -->
        <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="شعار الثانوية">
          <rect width="64" height="64" rx="12" fill="white" opacity="0.06"/>
          <path d="M10 44c0-10 10-20 22-22 12 2 22 12 22 22" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="22" cy="28" r="4" fill="#fff"/>
        </svg>
      </div>
      <div class="school-title">
        <div class="name">ثانوية أمــوشان رابح بقدارة</div>
        <div class="sub">تعليم - تربية - تميز</div>
      </div>
    </div>

    <nav class="main-nav" aria-label="قائمة الموقع">
      <a href="#news"><i class="fa-solid fa-newspaper"></i> الأخبار</a>
      <a href="#exams"><i class="fa-solid fa-calendar-check"></i> جداول الاختبارات</a>
      <a href="#schedule"><i class="fa-solid fa-clock"></i> مواعيد الدراسة</a>
      <a href="#contact"><i class="fa-solid fa-phone"></i> تواصل معنا</a>
    </nav>

    <!-- Mobile menu button -->
    <button class="menu-btn" id="menuBtn" aria-label="قائمة">
      <i class="fa-solid fa-bars"></i>
    </button>
  </header>

  <!-- ============= Hero / Welcome ============= -->
  <main class="container">
    <section class="hero card" aria-labelledby="welcomeTitle">
      <div class="welcome">
        <h1 id="welcomeTitle">مرحبا بكم في ثانوية أمــوشان رابح بقدارة</h1>
        <p>نسعى لتقديم بيئة تعليمية محفزة وملتزمة بقيم الاحترام والتميز. موقعنا هذا يعرض أحدث الأخبار، جداول الاختبارات، ومواعيد الحصص لتسهيل التواصل بين المؤسسة والتلاميذ والأسر.</p>
        <div class="credit">من فكرة أستاذة الإعلام الآلي وبرمجة تلميذها جاسر اشلاف</div>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
          <button class="btn" onclick="scrollToSection('news')"><i class="fa-solid fa-newspaper"></i> آخر الأخبار</button>
          <button class="btn secondary" onclick="scrollToSection('exams')"><i class="fa-solid fa-table-list"></i> الجدول الأسبوعي</button>
        </div>
      </div>

      <!-- Slider -->
      <div class="slider">
        <div class="slider-wrap card" aria-roledescription="carousel">
          <div class="slides" id="slides">
            <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&q=70&fit=crop&w=1200&h=700')">
              <div class="caption">
                <strong>أنشطة مدرسية</strong><br><small>فعالية ثقافية بمشاركة التلاميذ</small>
              </div>
            </div>
            <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1523240795612-9a054b0db644?auto=format&q=70&fit=crop&w=1200&h=700')">
              <div class="caption">
                <strong>مكتبة المدرسة</strong><br><small>تطوير الموارد لتدعيم التعلم</small>
              </div>
            </div>
            <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1497493292307-31c376b6e479?auto=format&q=70&fit=crop&w=1200&h=700')">
              <div class="caption">
                <strong>التعليم الرقمي</strong><br><small>ورشات تقنية وإعلام آلي</small>
              </div>
            </div>
          </div>
          <div class="slider-controls">
            <button id="prevSlide" aria-label="السابق"><i class="fa-solid fa-chevron-right"></i></button>
            <button id="nextSlide" aria-label="التالي"><i class="fa-solid fa-chevron-left"></i></button>
          </div>
        </div>
        <div class="slider-dots" id="sliderDots"></div>
      </div>
    </section>

    <!-- ============= Grid: News + Sidebar ============= -->
    <div class="grid container" style="margin-top:18px;">
      <!-- Main column: News & Exams -->
      <div>
        <!-- NEWS -->
        <section id="news" class="news-section card" aria-labelledby="newsTitle">
          <h2 id="newsTitle"><i class="fa-solid fa-newspaper"></i> الأخبار والمستجدات</h2>

          <!-- News cards -->
          <div class="news-list" id="newsList" aria-live="polite">
            <!-- JavaScript will inject news cards here -->
          </div>

          <!-- Admin panel (فقط وهميًا) -->
          <div class="admin-panel card" style="margin-top:12px;">
            <strong>لوحة الإدارة (وهمية عبر JavaScript)</strong>
            <p style="margin:6px 0;color:var(--muted)">أضف خبرًا جديدًا يظهر في قائمة الأخبار ويمكن أن يظهر كإشعار عاجل.</p>

            <div style="display:flex;gap:10px;flex-wrap:wrap">
              <input type="text" id="newsTitleInput" placeholder="عنوان الخبر (مثال: إعلان هام)" />
              <select id="newsType">
                <option value="normal">عادي</option>
                <option value="urgent">عاجل</option>
              </select>
            </div>
            <textarea id="newsBody" rows="3" placeholder="محتوى الخبر"></textarea>

            <div style="display:flex;gap:8px;">
              <button class="btn" id="addNewsBtn"><i class="fa-solid fa-plus"></i> أضف الخبر</button>
              <button class="btn secondary" id="clearNewsBtn"><i class="fa-solid fa-trash"></i> مسح الكل (محلي)</button>
            </div>

            <small style="display:block;margin-top:8px;color:var(--muted)">ملاحظة: الأخبار محفوظة محليًا في المتصفح (localStorage) فقط — لا توجد قاعدة بيانات.</small>
          </div>
        </section>

        <!-- Exams Table -->
        <section id="exams" class="card" style="margin-top:16px">
          <h2 style="margin:0 0 12px"><i class="fa-solid fa-calendar-days"></i> جداول الاختبارات</h2>
          <p style="color:var(--muted);margin:0 0 12px">يمكن تعديل الجداول في الكود أو إضافتها لاحقًا عبر واجهة الإدارة.</p>

          <div style="overflow:auto">
            <table class="schedule-table" aria-label="جدول الاختبارات">
              <thead>
                <tr>
                  <th>المادة</th>
                  <th>اليوم</th>
                  <th>التوقيت</th>
                  <th>القاعة</th>
                </tr>
              </thead>
              <tbody id="examsBody">
                <!-- Sample rows (يمكن تعديلها) -->
                <tr><td>الرياضيات</td><td>الاثنين 06/10/2025</td><td>09:00 - 11:00</td><td>قاعة 12</td></tr>
                <tr><td>اللغة العربية</td><td>الثلاثاء 07/10/2025</td><td>09:00 - 11:00</td><td>قاعة 05</td></tr>
                <tr><td>الفيزياء</td><td>الأربعاء 08/10/2025</td><td>13:00 - 15:00</td><td>مختبر 2</td></tr>
                <tr><td>اللغة الفرنسية</td><td>الخميس 09/10/2025</td><td>09:00 - 11:00</td><td>قاعة 08</td></tr>
              </tbody>
            </table>
          </div>
        </section>
      </div>

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="card">
          <h3><i class="fa-solid fa-clock"></i> مواعيد الدراسة</h3>
          <p style="color:var(--muted);margin-top:6px">عرض توقيت الحصص لفترتي الصباح والمساء.</p>

          <h4 style="margin-top:10px;color:var(--blue)">صباحًا</h4>
          <table class="schedule-table" style="margin-bottom:10px">
            <tbody>
              <tr><td>الحصة الأولى</td><td class="time-pill">08:00 - 08:45</td></tr>
              <tr><td>الحصة الثانية</td><td class="time-pill">08:55 - 09:40</td></tr>
              <tr><td>الحصة الثالثة</td><td class="time-pill">09:50 - 10:35</td></tr>
            </tbody>
          </table>

          <h4 style="margin-top:6px;color:var(--blue)">مساءً</h4>
          <table class="schedule-table">
            <tbody>
              <tr><td>الحصة الأولى</td><td class="time-pill">15:00 - 15:45</td></tr>
              <tr><td>الحصة الثانية</td><td class="time-pill">15:55 - 16:40</td></tr>
              <tr><td>الحصة الثالثة</td><td class="time-pill">16:50 - 17:35</td></tr>
            </tbody>
          </table>
        </div>

        <div class="card" style="margin-top:12px">
          <h3><i class="fa-solid fa-envelope"></i> معلومات سريعة</h3>
          <p style="color:var(--muted)">تواصل معنا للحصول على معلومات إضافية أو لحجز مواعيد.</p>
          <div style="margin-top:10px">
            <div class="contact-item"><i class="fa-solid fa-phone"></i> <div>+213 5X XXX XXXX</div></div>
            <div class="contact-item" style="margin-top:8px"><i class="fa-solid fa-location-dot"></i> <div>حي بقدارة - ولاية ... - الجزائر</div></div>
            <div class="contact-item" style="margin-top:8px"><i class="fa-solid fa-envelope"></i> <div>contact@amouchan.edu.dz</div></div>
          </div>
        </div>

      </aside>
    </div>
  </main>

  <!-- ============= Footer ============= -->
  <footer>
    <div class="footer-grid">
      <div style="max-width:540px">
        <h3 style="margin:0 0 8px;color:var(--blue)">ثانوية أمــوشان رابح بقدارة</h3>
        <p style="margin:0;color:var(--muted)">نطمح لتقديم تعليم متوازن ورقمنة الخدمات المدرسية. تابعنا على منصات التواصل لمعرفة آخر الأخبار والفعاليات.</p>
      </div>

      <div>
        <div style="margin-bottom:10px;color:var(--muted);font-weight:700">تواصل</div>
        <div class="contact-item"><i class="fa-solid fa-phone"></i> <div>+213 5X XXX XXXX</div></div>
        <div class="contact-item" style="margin-top:8px"><i class="fa-solid fa-location-dot"></i> <div>حي بقدارة - ولاية ... - الجزائر</div></div>
        <div class="contact-item" style="margin-top:8px"><i class="fa-solid fa-envelope"></i> <div>contact@amouchan.edu.dz</div></div>
        <div style="margin-top:12px" class="socials">
          <a href="#" title="فيسبوك"><i class="fa-brands fa-facebook-f"></i></a>
          <a href="#" title="تويتر"><i class="fa-brands fa-x-twitter"></i></a>
          <a href="#" title="انستغرام"><i class="fa-brands fa-instagram"></i></a>
        </div>
      </div>
    </div>
  </footer>

  <!-- ================================
       JavaScript (Embedded)
       ================================ -->
  <script>
    /****************************************
     * Utility helpers & initial data
     ****************************************/
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

    // Initial sample news (will be stored to localStorage)
    const SAMPLE_NEWS = [
      {id: genId(), title: 'افتتاح السنة الدراسية', body: 'يسر الثانوية أن تعلن عن افتتاح السنة الدراسية مرحبًا بكل التلاميذ.', date: '2025-09-01', type: 'normal'},
      {id: genId(), title: 'اختبار نهائي للفصل الأول', body: 'ستجرى الامتحانات النهائية بداية شهر أكتوبر، الرجاء مراجعة الجداول.', date: '2025-10-01', type: 'urgent'}
    ];

    function genId(){ return 'n_' + Math.random().toString(36).slice(2,9) }

    /****************************************
     * Persistent news storage (localStorage)
     ****************************************/
    const STORAGE_KEY = 'amouchan_news_v1';

    function loadNews(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(SAMPLE_NEWS));
          return SAMPLE_NEWS.slice();
        }
        return JSON.parse(raw);
      }catch(e){
        console.error('خطأ في تحميل الأخبار',e);
        return SAMPLE_NEWS.slice();
      }
    }

    function saveNews(news){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(news));
    }

    /****************************************
     * News rendering
     ****************************************/
    const newsListEl = $('#newsList');
    function renderNews(){
      const news = loadNews();
      newsListEl.innerHTML = '';
      // Sort by date desc (newest first)
      news.sort((a,b)=> new Date(b.date) - new Date(a.date));
      news.forEach(item => {
        const el = document.createElement('article');
        el.className = 'news-item';
        el.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:start;gap:8px">
            <div>
              <div class="title">${escapeHtml(item.title)}</div>
              <div class="meta"><span><i class="fa-regular fa-clock"></i> ${formatDate(item.date)}</span> <span style="color:${item.type==='urgent'?'#c53030':'#2aa66a'}">${item.type==='urgent'?'عاجل':''}</span></div>
            </div>
            <div style="width:48px;height:48px;border-radius:10px;display:grid;place-items:center;background:linear-gradient(180deg,rgba(11,103,178,0.08),rgba(42,166,106,0.06));color:var(--blue);font-weight:700">
              <i class="fa-solid fa-newspaper"></i>
            </div>
          </div>
          <div class="excerpt">${escapeHtml(item.body)}</div>
          <div style="display:flex;gap:8px;justify-content:flex-start;margin-top:8px">
            <button class="btn secondary" onclick="pinNotification('${item.id}')"><i class="fa-solid fa-bell"></i> نشر كإشعار</button>
            <button class="btn secondary" onclick="removeNews('${item.id}')" style="color:#c53030"><i class="fa-solid fa-trash"></i> حذف</button>
          </div>
        `;
        newsListEl.appendChild(el);
      });
    }

    function formatDate(d){
      if(!d) return '';
      const dt = new Date(d);
      if(isNaN(dt)) return d;
      return dt.toLocaleDateString('ar-DZ', {year:'numeric',month:'2-digit',day:'2-digit'});
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'",'&#039;');
    }

    function addNews(title, body, type='normal'){
      const news = loadNews();
      news.push({id: genId(), title, body, date: (new Date()).toISOString().slice(0,10), type});
      saveNews(news);
      renderNews();
    }

    function removeNews(id){
      let news = loadNews();
      news = news.filter(n=> n.id !== id);
      saveNews(news);
      renderNews();
    }

    function clearAllNews(){
      localStorage.removeItem(STORAGE_KEY);
      renderNews();
    }

    function pinNotification(id){
      const news = loadNews().find(n=> n.id === id);
      if(!news) return;
      const notifMsg = $('#notifMsg');
      notifMsg.textContent = `${news.title} — ${news.body}`;
      // visually show if hidden
      const bar = $('#notifBar');
      bar.style.display = 'flex';
      // if it's urgent, change style briefly
      if(news.type === 'urgent'){
        bar.style.background = '#c53030';
      } else {
        bar.style.background = 'var(--blue)';
      }
      setTimeout(()=>{ bar.style.background = 'var(--blue)'; }, 3500);
    }

    /****************************************
     * Notification bar toggle
     ****************************************/
    $('#notifToggle').addEventListener('click', function(){
      const bar = $('#notifBar');
      if(bar.style.display === 'none'){
        bar.style.display = 'flex';
        this.innerHTML = '<i class="fa-regular fa-bell"></i> إخفاء';
      } else {
        bar.style.display = 'none';
        this.innerHTML = '<i class="fa-regular fa-bell-slash"></i> إظهار';
      }
    });

    /****************************************
     * Admin form handlers
     ****************************************/
    $('#addNewsBtn').addEventListener('click', function(){
      const title = $('#newsTitleInput').value.trim();
      const body = $('#newsBody').value.trim();
      const type = $('#newsType').value;
      if(!title || !body){
        alert('الرجاء إدخال عنوان ومحتوى الخبر.');
        return;
      }
      addNews(title, body, type);
      // If urgent, show in notification bar immediately:
      if(type === 'urgent'){
        const last = loadNews().slice(-1)[0];
        pinNotification(last.id);
      }
      // clear form
      $('#newsTitleInput').value = '';
      $('#newsBody').value = '';
      $('#newsType').value = 'normal';
    });

    $('#clearNewsBtn').addEventListener('click', function(){
      if(confirm('هل تود مسح جميع الأخبار المحفوظة محليًا؟')) {
        clearAllNews();
      }
    });

    /****************************************
     * Slider functionality
     ****************************************/
    (function sliderInit(){
      const slides = $('#slides');
      const slideEls = $$('.slide', slides);
      const dotsContainer = $('#sliderDots');
      let idx = 0;
      let autoplay = true;
      let timer = null;
      const total = slideEls.length;

      function goTo(i){
        idx = (i + total) % total;
        slides.style.transform = `translateX(-${idx * 100}%)`;
        // update dots
        $$('.dot', dotsContainer).forEach((d,ind)=> d.classList.toggle('active', ind===idx));
      }

      // create dots
      for(let i=0;i<total;i++){
        const d = document.createElement('div');
        d.className = 'dot';
        d.addEventListener('click', ()=>{ goTo(i); resetAuto(); });
        dotsContainer.appendChild(d);
      }

      $('#nextSlide').addEventListener('click', ()=>{ goTo(idx+1); resetAuto(); });
      $('#prevSlide').addEventListener('click', ()=>{ goTo(idx-1); resetAuto(); });

      function auto(){
        timer = setInterval(()=> goTo(idx+1), 4200);
      }
      function resetAuto(){
        if(timer) clearInterval(timer);
        if(autoplay) auto();
      }
      // pause on hover
      $('.slider-wrap').addEventListener('mouseenter', ()=>{ if(timer) clearInterval(timer); });
      $('.slider-wrap').addEventListener('mouseleave', ()=>{ if(autoplay) auto(); });

      goTo(0);
      auto();
    })();

    /****************************************
     * Mobile menu toggle
     ****************************************/
    $('#menuBtn').addEventListener('click', function(){
      const nav = document.querySelector('nav.main-nav');
      if(nav.style.display === 'flex'){
        nav.style.display = '';
      } else {
        nav.style.display = 'flex';
        nav.style.position = 'absolute';
        nav.style.right = '14px';
        nav.style.top = '84px';
        nav.style.background = 'var(--glass-2)';
        nav.style.padding = '10px';
        nav.style.boxShadow = 'var(--shadow)';
        nav.style.borderRadius = '12px';
        nav.style.flexDirection = 'column';
      }
    });

    /****************************************
     * Helpers & initial render
     ****************************************/
    function scrollToSection(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({behavior:'smooth', block:'start'});
    }

    // Preload: render news
    renderNews();

    // If there is an urgent news in storage, show it in the top bar initially
    (function showInitialUrgent(){
      const news = loadNews();
      const urgent = news.find(n => n.type === 'urgent');
      if(urgent){
        $('#notifMsg').textContent = `${urgent.title} — ${urgent.body}`;
        $('#notifBar').style.background = '#c53030';
        setTimeout(()=>{ $('#notifBar').style.background = 'var(--blue)';}, 3000);
      }
    })();

    /****************************************
     * Small extra: keyboard shortcuts (pro)
     ****************************************/
    document.addEventListener('keydown', (e) => {
      // Ctrl+N to focus add news title
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'n'){
        e.preventDefault();
        $('#newsTitleInput').focus();
      }
    });

    // Accessibility: ensure images have alt (slides are decorative here)
  </script>
</body>
</html>
